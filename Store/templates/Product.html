{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/png" href="{% static 'Images/circle.png' %}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Project Store | Software, Hardware, AI & Robotics Projects</title>
  <meta name="description" content="Explore our Project Store featuring software, hardware, AI, and robotics projects. From face recognition systems to automation tools, we deliver innovative solutions.">
  <meta name="keywords" content="project store, software projects, hardware projects, AI projects, robotics projects, automation systems, face recognition, IoT projects, machine learning, student projects, final year projects">

  <!-- Bootstrap & Fonts -->
  <link rel="stylesheet" href="{% static 'style.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

  <style>
    body { font-family: Arial, sans-serif; overflow-x: hidden; }
    .container { width: 80%; margin: 0 auto; padding: 40px 0; }
    h1 { font-size: 2rem; font-weight: bold; text-align: center; margin-bottom: 20px; }
    .swiper { width: 100%; padding: 20px 0; }
    .swiper-wrapper { display: flex; align-items: center; }
    .card { border: 2px solid #ddd; border-radius: 8px; padding: 5px; background-color: #fff; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); text-align: center; width: 100%; }
    .card img { width: 100%; height: 200px; object-fit: contain; border-radius: 8px; }
    .card-body { flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between; }
    .card-title { font-size: 1.25rem; font-weight: bold; color: #007bff; text-align: start; }
    .card-text { font-size: 1rem; color: #555; text-align: start; }
    .card-price { font-size: 1.25rem; color: #dc3545; font-weight: bold; }
    .btn-add-to-cart { background-color: #28a745; color: #fff; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
    .btn-add-to-cart:hover { background-color: #218838; }
    .swiper-button-next::after, .swiper-button-prev::after { content: ''; display: none; }
    .swiper-button-next, .swiper-button-prev { position: absolute; top: 50%; transform: translateY(-50%); z-index: 10; background-color: white; border-radius: 50%; width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer;  }
    .swiper-button-next:hover, .swiper-button-prev:hover { background-color: rgba(0, 0, 0, 0.8); }
    .swiper-button-next i, .swiper-button-prev i { font-size: 24px; color: white; display: block; line-height: 1; padding: 5px; }
    .cart-sidebar { width: 100%; max-width: 390px; height: 100%; position: fixed; top: 0; right: -100%; background: #fff; box-shadow: -2px 0 5px rgba(0, 0, 0, 0.5); transition: right 0.3s ease; z-index: 10000; }
    .cart-sidebar.open { right: 0; }
    .cart-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
    .alert-container { position: fixed; top: 20px; right: 20px; z-index: 1100; width: 350px; }
    @media (max-width: 576px) {
      .swiper-button-next, .swiper-button-prev { width: 40px; height: 40px; }
      .card img { max-height: 150px; }
    }
  </style>
</head>
<body>
  {% include 'Includes/navbar.html' %}

  <!-- Alert Container -->
  <div class="alert-container"></div>

  <div class="container-fluid bg-light">
    <div class="container px-2 px-md-3">
      <div class="row py-4 py-md-1">
        <nav style="--bs-breadcrumb-divider: url(&#34;data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8'%3E%3Cpath d='M2.5 0L1 1.5 3.5 4 1 6.5 2.5 8l4-4-4-4z' fill='%236c757d'/%3E%3C/svg%3E&#34;);" aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item">
              <a href="{% url 'home' %}" class="text-decoration-none fs-4">Home</a>
            </li>
            <li class="breadcrumb-item active fs-4" aria-current="page">Products</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>

{% for category in categories %}
  {% if category.only_products %}
    <section id="{{ category.slug }}">
      <div class="container px-0 px-md-3">
        <div class="d-flex justify-content-between align-items-center">
          <h1 class="fw-bold text-start mt-3">{{ category.name }}</h1>
          <a href="{% url 'category_products' category.slug %}" class="btn btn-success">View All</a>
        </div>
        <div class="swiper" id="swiper-{{ category.slug }}">
          <div class="swiper-wrapper">
            {% for product in category.products.all %}
              {% if not product.is_project %}
                <div class="swiper-slide">
                  <div class="card product-card" data-price="{{ product.price }}">
                    <img src="{{ product.main_image.url }}" alt="{{ product.name }}">
                    <div class="card-body">
                      <h2 class="card-title text-dark">{{ product.name }}</h2>
                      <p class="card-text">{{ product.short_description|truncatechars:35 }}</p>
                      <div class="d-flex justify-content-between align-items-center">
                        <a href="{% url 'product_detail' product.slug %}" class="btn btn-success">Show More</a>
                        <h4 class="card-price">{{ product.price }}</h4>
                      </div>
                    </div>
                  </div>
                </div>
              {% endif %}
            {% empty %}
              <p class="text-muted mt-3">No products available in this category.</p>
            {% endfor %}
          </div>
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
        </div>
      </div>
    </section>
  {% endif %}
{% endfor %}


  <!-- Cart Sidebar -->
  <div class="cart-sidebar" id="cartSidebar">
    <button class="btn-close float-end mt-3 me-3" id="closeCart"></button>
    <div class="p-3">
      <h5>Shopping Cart</h5>
    </div>
    <div id="cartItems" class="px-3"></div>
    <div class="p-3">
      <p><strong>Subtotal:</strong> Rs <span id="cartTotal">0</span> PKR</p>
      <a class="btn btn-success w-100" href="{% url 'checkout' %}">Checkout</a>
    </div>
  </div>

  <div class="position-fixed bottom-0 end-0 m-4" style="z-index:1000;">
    <!-- Small screens (icon only) -->
    <a href="https://wa.me/923104505008" target="_blank"
       class="btn btn-success rounded-circle shadow-lg d-flex align-items-center justify-content-center d-md-none"
       style="width:60px; height:60px;">
      <i class="bi bi-whatsapp fs-3 text-white"></i>
    </a>

    <!-- Medium & Large screens (icon + text) -->
    <a href="https://wa.me/923104505008" target="_blank"
       class="btn btn-success shadow-lg d-none d-md-flex align-items-center px-3 py-2">
      <i class="bi bi-whatsapp fs-3 text-white me-2"></i>
      <span class="fs-5 text-white fw-bold">Chat</span>
    </a>
  </div>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
  <script>
    // Initialize Swiper for each category
    document.querySelectorAll('.swiper').forEach(swiperElement => {
      new Swiper(swiperElement, {
        slidesPerView: 1,
        spaceBetween: 10,
        navigation: {
          nextEl: swiperElement.querySelector('.swiper-button-next'),
          prevEl: swiperElement.querySelector('.swiper-button-prev'),
        },
        breakpoints: {
          768: { slidesPerView: 2, spaceBetween: 20 },
          992: { slidesPerView: 3, spaceBetween: 30 },
        },
      });
    });
  </script>
</body>
</html>
